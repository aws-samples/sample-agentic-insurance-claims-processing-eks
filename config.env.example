# ============================================================================
# Configuration File for Insurance Claims Processing System
# ============================================================================
#
# Instructions:
# 1. Copy this file to config.env: cp config.env.example config.env
# 2. Update all values below with your environment-specific settings
# 3. Source this file before running deployment scripts: source config.env
#
# ============================================================================

# AWS Configuration
# ============================================================================
export AWS_REGION="us-west-2"                    # AWS region for deployment
export AWS_ACCOUNT_ID="123255318457"             # Your AWS account ID
export EKS_CLUSTER_NAME="agentic-eks-cluster"    # Name of your EKS cluster

# Container Registry (ECR)
# ============================================================================
export ECR_REGISTRY="${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com"
export ECR_REPOSITORY_PREFIX="insurance-claims"  # Prefix for all ECR repositories

# Image Tags
# ============================================================================
export IMAGE_TAG="latest"                        # Docker image tag (use version numbers for prod)

# Kubernetes Configuration
# ============================================================================
export K8S_NAMESPACE="insurance-claims"          # Kubernetes namespace
export KARPENTER_NODEPOOL="cpu-nodepool"         # Karpenter node pool name

# Database Configuration
# ============================================================================
export MONGODB_USER="admin"
export MONGODB_PASSWORD="<YOUR_MONGODB_PASSWORD>"  # CHANGE THIS IN PRODUCTION!
export MONGODB_DATABASE="claims_db"
export MONGODB_PORT="27017"

# Service Configuration
# ============================================================================
export OLLAMA_MODEL="qwen2.5-coder:7b"           # LLM model to use
export REDIS_PORT="6379"
export SHARED_MEMORY_PORT="8001"
export COORDINATOR_PORT="8000"
export WEB_INTERFACE_PORT="8080"
export SIMULATOR_PORT="8091"
export POLICY_AGENT_PORT="8002"
export EXTERNAL_INTEGRATIONS_PORT="8003"
export OLLAMA_PORT="11434"

# Demo Configuration
# ============================================================================
export CLAIMS_PER_MINUTE="20"                    # Rate of claim generation
export FRAUD_RATE="0.25"                         # 25% of claims are fraudulent
export MAX_DEMO_CLAIMS="25000"                   # Stop simulator at this count
export MAX_CLAIMS_DISPLAY="100"                  # Max claims to show in UI

# Resource Limits (adjust based on your cluster capacity)
# ============================================================================
# Coordinator
export COORDINATOR_REPLICAS="2"
export COORDINATOR_CPU_REQUEST="150m"
export COORDINATOR_CPU_LIMIT="300m"
export COORDINATOR_MEM_REQUEST="256Mi"
export COORDINATOR_MEM_LIMIT="512Mi"

# Web Interface
export WEB_INTERFACE_REPLICAS="2"
export WEB_INTERFACE_CPU_REQUEST="100m"
export WEB_INTERFACE_CPU_LIMIT="200m"
export WEB_INTERFACE_MEM_REQUEST="128Mi"
export WEB_INTERFACE_MEM_LIMIT="256Mi"

# Policy Agent
export POLICY_AGENT_REPLICAS="2"
export POLICY_AGENT_CPU_REQUEST="100m"
export POLICY_AGENT_CPU_LIMIT="200m"
export POLICY_AGENT_MEM_REQUEST="128Mi"
export POLICY_AGENT_MEM_LIMIT="256Mi"

# External Integrations
export EXTERNAL_INTEGRATIONS_REPLICAS="2"
export EXTERNAL_INTEGRATIONS_CPU_REQUEST="100m"
export EXTERNAL_INTEGRATIONS_CPU_LIMIT="200m"
export EXTERNAL_INTEGRATIONS_MEM_REQUEST="128Mi"
export EXTERNAL_INTEGRATIONS_MEM_LIMIT="256Mi"

# Shared Memory
export SHARED_MEMORY_REPLICAS="2"
export SHARED_MEMORY_CPU_REQUEST="100m"
export SHARED_MEMORY_CPU_LIMIT="200m"
export SHARED_MEMORY_MEM_REQUEST="128Mi"
export SHARED_MEMORY_MEM_LIMIT="256Mi"

# Claims Simulator
export SIMULATOR_REPLICAS="1"
export SIMULATOR_CPU_REQUEST="100m"
export SIMULATOR_CPU_LIMIT="200m"
export SIMULATOR_MEM_REQUEST="128Mi"
export SIMULATOR_MEM_LIMIT="256Mi"

# MongoDB
export MONGODB_REPLICAS="1"
export MONGODB_CPU_REQUEST="250m"
export MONGODB_CPU_LIMIT="500m"
export MONGODB_MEM_REQUEST="512Mi"
export MONGODB_MEM_LIMIT="1Gi"
export MONGODB_STORAGE="10Gi"

# Redis
export REDIS_REPLICAS="1"
export REDIS_CPU_REQUEST="100m"
export REDIS_CPU_LIMIT="200m"
export REDIS_MEM_REQUEST="128Mi"
export REDIS_MEM_LIMIT="256Mi"

# Ollama
export OLLAMA_REPLICAS="1"
export OLLAMA_CPU_REQUEST="1000m"
export OLLAMA_CPU_LIMIT="2000m"
export OLLAMA_MEM_REQUEST="2Gi"
export OLLAMA_MEM_LIMIT="4Gi"

# Ingress / Load Balancer Configuration
# ============================================================================
export ALB_SCHEME="internet-facing"              # or "internal" for private ALB
export ALB_NAME="insurance-claims-alb"
export INGRESS_CLASS="alb"

# Optional: Custom Domain (leave empty if not using)
# ============================================================================
export CUSTOM_DOMAIN=""                          # e.g., "claims.yourcompany.com"
export CERTIFICATE_ARN=""                        # ACM certificate ARN for HTTPS

# ============================================================================
# DO NOT EDIT BELOW THIS LINE (Computed values)
# ============================================================================

# Computed MongoDB URL
export MONGODB_URL="mongodb://${MONGODB_USER}:${MONGODB_PASSWORD}@mongodb-service.${K8S_NAMESPACE}.svc.cluster.local:${MONGODB_PORT}/${MONGODB_DATABASE}?authSource=admin"

# Computed Redis URL
export REDIS_URL="redis://redis-service.${K8S_NAMESPACE}.svc.cluster.local:${REDIS_PORT}"

# Computed service endpoints
export SHARED_MEMORY_URL="http://shared-memory-service.${K8S_NAMESPACE}.svc.cluster.local:${SHARED_MEMORY_PORT}"
export OLLAMA_ENDPOINT="http://ollama-service.${K8S_NAMESPACE}.svc.cluster.local:${OLLAMA_PORT}"
export COORDINATOR_URL="http://coordinator-service.${K8S_NAMESPACE}.svc.cluster.local:${COORDINATOR_PORT}"
export POLICY_AGENT_URL="http://policy-agent-service.${K8S_NAMESPACE}.svc.cluster.local:${POLICY_AGENT_PORT}"
export EXTERNAL_INTEGRATIONS_URL="http://external-integrations-service.${K8S_NAMESPACE}.svc.cluster.local:${EXTERNAL_INTEGRATIONS_PORT}"

# Image names
export COORDINATOR_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/coordinator:${IMAGE_TAG}"
export WEB_INTERFACE_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/web-interface:${IMAGE_TAG}"
export SIMULATOR_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/claims-simulator:${IMAGE_TAG}"
export POLICY_AGENT_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/policy-agent:${IMAGE_TAG}"
export EXTERNAL_INTEGRATIONS_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/external-integrations:${IMAGE_TAG}"
export SHARED_MEMORY_IMAGE="${ECR_REGISTRY}/${ECR_REPOSITORY_PREFIX}/shared-memory:${IMAGE_TAG}"

echo "âœ… Configuration loaded successfully!"
echo "   AWS Region: ${AWS_REGION}"
echo "   AWS Account: ${AWS_ACCOUNT_ID}"
echo "   ECR Registry: ${ECR_REGISTRY}"
echo "   Namespace: ${K8S_NAMESPACE}"
